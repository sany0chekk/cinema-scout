{"version":3,"file":"commonHelpers.js","sources":["../src/js/movie-api.js","../src/js/render-list.js","../src/js/render-movie-info.js"],"sourcesContent":["'use strict';\n\nconst API_KEY = 'b210b8c265aa45ab35b8876089232222';\nconst AUTH_TOKEN =\n  'eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiJiMjEwYjhjMjY1YWE0NWFiMzViODg3NjA4OTIzMjIyMiIsInN1YiI6IjY2M2JjY2JlYmRjMjJhNDAxNjAxMDk3NCIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.zjkAl594EP84PYZFIQ6iSotECJtDLEMUn35DsNJdj60';\nconst options = {\n  method: 'GET',\n  headers: {\n    accept: 'application/json',\n    Authorization: `Bearer ${AUTH_TOKEN}`,\n  },\n};\n\nconst BASE_URL = 'https://api.themoviedb.org/3';\n\nexport async function fetchMoviesList(query, page) {\n  const params = new URLSearchParams({\n    api_key: API_KEY,\n    include_adult: false,\n    language: 'en-US',\n    page,\n    query,\n  });\n\n  const result = await fetch(`${BASE_URL}/search/movie?${params}`, options);\n  return result.json();\n}\n\nexport async function fetchMovie(id) {\n  const params = new URLSearchParams({\n    api_key: API_KEY,\n    language: 'en-US',\n  });\n\n  const result = await fetch(`${BASE_URL}/movie/${id}?${params}`, options);\n  return result.json();\n}\n\nexport async function fetchPopularMovies() {\n  const params = new URLSearchParams({\n    api_key: API_KEY,\n    language: 'en-US',\n    page: 1,\n  });\n\n  const result = await fetch(`${BASE_URL}/movie/popular?${params}`, options);\n  return result.json();\n}\n\nexport async function fetchMovieTrailer(id) {\n  const params = new URLSearchParams({\n    api_key: API_KEY,\n    language: 'en-US',\n  });\n\n  const result = await fetch(\n    `${BASE_URL}/movie/${id}/videos?${params}`,\n    options\n  );\n  return result.json();\n}\n","'use strict';\n\nimport { fetchMoviesList, fetchPopularMovies } from './movie-api';\n\nrenderPopularMovies();\n\nlet currentPage = 1;\n\nconst searchForm = document.querySelector('.header-search');\nsearchForm.addEventListener('submit', event => {\n  const pageCounterEl = document.querySelector('.library-page');\n  currentPage = 1;\n  pageCounterEl.textContent = currentPage;\n  renderElements(event);\n});\n\nconst prevPageBtn = document.querySelector('.library-prev-btn');\nconst nextPageBtn = document.querySelector('.library-next-btn');\n\nprevPageBtn.addEventListener('click', handlePrevPage);\nnextPageBtn.addEventListener('click', handleNextPage);\n\nfunction handlePrevPage() {\n  const pageCounterEl = document.querySelector('.library-page');\n  currentPage--;\n  renderElements(event);\n  pageCounterEl.textContent = currentPage;\n\n  window.scrollTo({\n    top: 0,\n    behavior: 'smooth',\n  });\n}\n\nfunction handleNextPage() {\n  const pageCounterEl = document.querySelector('.library-page');\n  currentPage++;\n  renderElements(event);\n  pageCounterEl.textContent = currentPage;\n\n  window.scrollTo({\n    top: 0,\n    behavior: 'smooth',\n  });\n}\n\nwindow.addEventListener('popstate', handlePopstate);\n\nfunction handlePopstate(event) {\n  const pathname = location.pathname;\n\n  if (pathname === '/popular') {\n    currentPage = 1;\n    renderPopularMovies();\n  } else if (pathname.startsWith('/search/')) {\n    const pathParts = pathname.substring('/search/'.length).split('/');\n    const searchPage = pathParts[0] || 1;\n    const searchQuery = pathParts[1] || '';\n    currentPage = parseInt(searchPage, 10);\n    renderElements({\n      target: { elements: { 'header-search-input': { value: searchQuery } } },\n    });\n  }\n}\n\nasync function renderElements(event) {\n  event.preventDefault();\n  const movieName = searchForm.querySelector('.header-search-input');\n  const libraryEl = document.querySelector('.library-list');\n  const loader = document.querySelector('.library-loader');\n  const message = document.querySelector('.library-message');\n  const libraryTitle = document.querySelector('.library-title');\n  const libraryPaginationEl = document.querySelector('.library-pagination');\n\n  loader.classList.remove('hide');\n  libraryEl.innerHTML = '';\n\n  try {\n    const data = await fetchMoviesList(movieName.value.trim(), currentPage);\n\n    libraryTitle.innerHTML = `Search query: <span>${movieName.value.trim()}</span>`;\n\n    if (!data.results.length) {\n      message.classList.add('active');\n      libraryPaginationEl.classList.remove('active');\n    } else {\n      message.classList.remove('active');\n\n      const markup = data.results\n        .map(\n          ({\n            id,\n            title,\n            overview,\n            release_date: date,\n            vote_average: rate,\n            poster_path: img,\n          }) => {\n            if (!img) {\n              return '';\n            }\n\n            return `\n          <li class=\"library-item\">\n          <img src=\"https://image.tmdb.org/t/p/w500/${img}\" alt=\"${title}\" class=\"library-item-poster\" />\n          <div class=\"library-item-content\">\n          <h3 class=\"library-item-title\">${title}</h3>\n          <p class=\"library-item-date library-item-text\">Release date: <span>${date}</span></p>\n          <p class=\"library-item-rate library-item-text\">Rating: <span>${rate}</span></p>\n          <button type=\"button\" class=\"library-item-btn\" data-id=\"${id}\">Read more</button>\n          </div>\n          </li>\n          `;\n          }\n        )\n        .join('');\n      libraryEl.insertAdjacentHTML('beforeend', markup);\n      libraryPaginationEl.classList.add('active');\n\n      const totalPages = data.total_pages;\n\n      if (currentPage >= totalPages) {\n        nextPageBtn.disabled = true;\n      } else {\n        nextPageBtn.disabled = false;\n      }\n\n      if (currentPage <= 1) {\n        prevPageBtn.disabled = true;\n      } else {\n        prevPageBtn.disabled = false;\n      }\n    }\n\n    if (movieName.value.trim()) {\n      history.pushState(\n        {},\n        '',\n        `/search/${movieName.value.trim()}/${currentPage}`\n      );\n    } else {\n      history.pushState({}, '', '/popular');\n    }\n  } catch (error) {\n    console.log(error);\n  } finally {\n    loader.classList.add('hide');\n  }\n}\n\nasync function renderPopularMovies() {\n  const libraryEl = document.querySelector('.library-list');\n  const loader = document.querySelector('.library-loader');\n\n  history.pushState({}, '', '/popular');\n\n  libraryEl.innerHTML = '';\n  loader.classList.remove('hide');\n\n  try {\n    const data = await fetchPopularMovies();\n\n    const markup = data.results\n      .map(\n        ({\n          id,\n          title,\n          overview,\n          release_date: date,\n          vote_average: rate,\n          poster_path: img,\n        }) => {\n          if (!img) {\n            return '';\n          }\n\n          return `\n        <li class=\"library-item\">\n          <img src=\"https://image.tmdb.org/t/p/w500/${img}\" alt=\"${title}\" class=\"library-item-poster\" />\n          <div class=\"library-item-content\">\n            <h3 class=\"library-item-title\">${title}</h3>\n            <p class=\"library-item-date library-item-text\">Release date: <span>${date}</span></p>\n            <p class=\"library-item-rate library-item-text\">Rating: <span>${rate}</span></p>\n            <button type=\"button\" class=\"library-item-btn\" data-id=\"${id}\">Read more</button>\n          </div>\n        </li>\n      `;\n        }\n      )\n      .join('');\n    libraryEl.insertAdjacentHTML('beforeend', markup);\n  } catch (error) {\n    console.log(error);\n  } finally {\n    loader.classList.add('hide');\n  }\n}\n","'use strict';\n\nimport * as basicLightbox from 'basiclightbox';\nimport 'basiclightbox/dist/basicLightbox.min.css';\n\nimport Swal from 'sweetalert2';\n\nimport { fetchMovie, fetchMovieTrailer } from './movie-api';\n\nconst libraryEl = document.querySelector('.library-list');\nconst modalCloseBtn = document.querySelector('.modal-close-btn');\n\nmodalCloseBtn.addEventListener('click', event => {\n  event.target.closest('.backdrop').classList.remove('active');\n  document.body.style.overflow = null;\n});\n\nlibraryEl.addEventListener('click', renderMovieInfo);\n\nasync function renderMovieInfo(event) {\n  if (event.target.classList.contains('library-item-btn')) {\n    const id = event.target.dataset.id;\n    const loader = document.querySelector('.modal-loader');\n    const modalEl = document.querySelector('.modal');\n\n    loader.classList.remove('hide');\n\n    try {\n      const data = await fetchMovie(id);\n\n      const {\n        id: videoID,\n        poster_path: img,\n        title,\n        status,\n        release_date,\n        genres,\n        vote_average: rating,\n        overview,\n      } = data;\n\n      const modalVideoBtn = modalEl.querySelector('.modal-video-btn');\n      const modalElements = {\n        img: modalEl.querySelector('.modal-img'),\n        title: modalEl.querySelector('.modal-title'),\n        status: modalEl.querySelector('.modal-status span'),\n        release: modalEl.querySelector('.modal-released span'),\n        rating: modalEl.querySelector('.modal-rating span'),\n        descr: modalEl.querySelector('.modal-descr'),\n      };\n      modalElements.img.src = `https://image.tmdb.org/t/p/w500/${img}`;\n      modalElements.img.alt = title;\n      modalElements.title.textContent = title;\n      modalElements.status.textContent = status;\n      modalElements.release.textContent = release_date;\n      modalElements.rating.textContent = rating;\n      modalElements.descr.textContent = overview;\n\n      modalVideoBtn.dataset.id = videoID;\n\n      modalEl.classList.add('active');\n      document.body.style.overflow = 'hidden';\n\n      modalVideoBtn.addEventListener('click', showMovieTrailer);\n    } catch (error) {\n      console.log(error);\n    } finally {\n      loader.classList.add('hide');\n    }\n  }\n}\n\nasync function showMovieTrailer(event) {\n  const id = event.currentTarget.dataset.id;\n\n  try {\n    const data = await fetchMovieTrailer(id);\n\n    if (!data.results.length) {\n      Swal.fire({\n        icon: 'error',\n        title: 'Oops...',\n        text: \"We couldn't find the trailer for this movie\",\n      });\n    } else {\n      const key = data.results[0].key;\n\n      const instance = basicLightbox.create(`\n    <iframe src=\"https://www.youtube.com/embed/${key}\" width=\"800\" height=\"500\" frameborder=\"0\"></iframe>\n  `);\n\n      instance.show();\n    }\n  } catch (error) {\n    console.log(error);\n  }\n}\n"],"names":["API_KEY","AUTH_TOKEN","options","BASE_URL","fetchMoviesList","query","page","params","fetchMovie","id","fetchPopularMovies","fetchMovieTrailer","renderPopularMovies","currentPage","searchForm","event","pageCounterEl","renderElements","prevPageBtn","nextPageBtn","handlePrevPage","handleNextPage","handlePopstate","pathname","pathParts","searchPage","searchQuery","movieName","libraryEl","loader","message","libraryTitle","libraryPaginationEl","data","markup","title","overview","date","rate","img","totalPages","error","modalCloseBtn","renderMovieInfo","modalEl","videoID","status","release_date","genres","rating","modalVideoBtn","modalElements","showMovieTrailer","Swal","key","basicLightbox.create"],"mappings":"6vBAEA,MAAMA,EAAU,mCACVC,EACJ,sNACIC,EAAU,CACd,OAAQ,MACR,QAAS,CACP,OAAQ,mBACR,cAAe,UAAUD,CAAU,EACpC,CACH,EAEME,EAAW,+BAEV,eAAeC,EAAgBC,EAAOC,EAAM,CACjD,MAAMC,EAAS,IAAI,gBAAgB,CACjC,QAASP,EACT,cAAe,GACf,SAAU,QACV,KAAAM,EACA,MAAAD,CACJ,CAAG,EAGD,OADe,MAAM,MAAM,GAAGF,CAAQ,iBAAiBI,CAAM,GAAIL,CAAO,GAC1D,MAChB,CAEO,eAAeM,EAAWC,EAAI,CACnC,MAAMF,EAAS,IAAI,gBAAgB,CACjC,QAASP,EACT,SAAU,OACd,CAAG,EAGD,OADe,MAAM,MAAM,GAAGG,CAAQ,UAAUM,CAAE,IAAIF,CAAM,GAAIL,CAAO,GACzD,MAChB,CAEO,eAAeQ,GAAqB,CACzC,MAAMH,EAAS,IAAI,gBAAgB,CACjC,QAASP,EACT,SAAU,QACV,KAAM,CACV,CAAG,EAGD,OADe,MAAM,MAAM,GAAGG,CAAQ,kBAAkBI,CAAM,GAAIL,CAAO,GAC3D,MAChB,CAEO,eAAeS,EAAkBF,EAAI,CAC1C,MAAMF,EAAS,IAAI,gBAAgB,CACjC,QAASP,EACT,SAAU,OACd,CAAG,EAMD,OAJe,MAAM,MACnB,GAAGG,CAAQ,UAAUM,CAAE,WAAWF,CAAM,GACxCL,CACJ,GACgB,MAChB,CCxDAU,IAEA,IAAIC,EAAc,EAElB,MAAMC,EAAa,SAAS,cAAc,gBAAgB,EAC1DA,EAAW,iBAAiB,SAAUC,GAAS,CAC7C,MAAMC,EAAgB,SAAS,cAAc,eAAe,EAC5DH,EAAc,EACdG,EAAc,YAAcH,EAC5BI,EAAeF,CAAK,CACtB,CAAC,EAED,MAAMG,EAAc,SAAS,cAAc,mBAAmB,EACxDC,EAAc,SAAS,cAAc,mBAAmB,EAE9DD,EAAY,iBAAiB,QAASE,CAAc,EACpDD,EAAY,iBAAiB,QAASE,CAAc,EAEpD,SAASD,GAAiB,CACxB,MAAMJ,EAAgB,SAAS,cAAc,eAAe,EAC5DH,IACAI,EAAe,KAAK,EACpBD,EAAc,YAAcH,EAE5B,OAAO,SAAS,CACd,IAAK,EACL,SAAU,QACd,CAAG,CACH,CAEA,SAASQ,GAAiB,CACxB,MAAML,EAAgB,SAAS,cAAc,eAAe,EAC5DH,IACAI,EAAe,KAAK,EACpBD,EAAc,YAAcH,EAE5B,OAAO,SAAS,CACd,IAAK,EACL,SAAU,QACd,CAAG,CACH,CAEA,OAAO,iBAAiB,WAAYS,CAAc,EAElD,SAASA,EAAeP,EAAO,CAC7B,MAAMQ,EAAW,SAAS,SAE1B,GAAIA,IAAa,WACfV,EAAc,EACdD,YACSW,EAAS,WAAW,UAAU,EAAG,CAC1C,MAAMC,EAAYD,EAAS,UAAU,CAAiB,EAAE,MAAM,GAAG,EAC3DE,EAAaD,EAAU,CAAC,GAAK,EAC7BE,EAAcF,EAAU,CAAC,GAAK,GACpCX,EAAc,SAASY,EAAY,EAAE,EACrCR,EAAe,CACb,OAAQ,CAAE,SAAU,CAAE,sBAAuB,CAAE,MAAOS,CAAW,EAAM,CAC7E,CAAK,CACF,CACH,CAEA,eAAeT,EAAeF,EAAO,CACnCA,EAAM,eAAc,EACpB,MAAMY,EAAYb,EAAW,cAAc,sBAAsB,EAC3Dc,EAAY,SAAS,cAAc,eAAe,EAClDC,EAAS,SAAS,cAAc,iBAAiB,EACjDC,EAAU,SAAS,cAAc,kBAAkB,EACnDC,EAAe,SAAS,cAAc,gBAAgB,EACtDC,EAAsB,SAAS,cAAc,qBAAqB,EAExEH,EAAO,UAAU,OAAO,MAAM,EAC9BD,EAAU,UAAY,GAEtB,GAAI,CACF,MAAMK,EAAO,MAAM7B,EAAgBuB,EAAU,MAAM,KAAI,EAAId,CAAW,EAItE,GAFAkB,EAAa,UAAY,uBAAuBJ,EAAU,MAAM,KAAI,CAAE,UAElE,CAACM,EAAK,QAAQ,OAChBH,EAAQ,UAAU,IAAI,QAAQ,EAC9BE,EAAoB,UAAU,OAAO,QAAQ,MACxC,CACLF,EAAQ,UAAU,OAAO,QAAQ,EAEjC,MAAMI,EAASD,EAAK,QACjB,IACC,CAAC,CACC,GAAAxB,EACA,MAAA0B,EACA,SAAAC,EACA,aAAcC,EACd,aAAcC,EACd,YAAaC,CACzB,IACiBA,EAIE;AAAA;AAAA,sDAEmCA,CAAG,UAAUJ,CAAK;AAAA;AAAA,2CAE7BA,CAAK;AAAA,+EAC+BE,CAAI;AAAA,yEACVC,CAAI;AAAA,oEACT7B,CAAE;AAAA;AAAA;AAAA,YAVjD,EAeZ,EACA,KAAK,EAAE,EACVmB,EAAU,mBAAmB,YAAaM,CAAM,EAChDF,EAAoB,UAAU,IAAI,QAAQ,EAE1C,MAAMQ,EAAaP,EAAK,YAEpBpB,GAAe2B,EACjBrB,EAAY,SAAW,GAEvBA,EAAY,SAAW,GAGrBN,GAAe,EACjBK,EAAY,SAAW,GAEvBA,EAAY,SAAW,EAE1B,CAEGS,EAAU,MAAM,OAClB,QAAQ,UACN,CAAE,EACF,GACA,WAAWA,EAAU,MAAM,KAAI,CAAE,IAAId,CAAW,EACxD,EAEM,QAAQ,UAAU,CAAA,EAAI,GAAI,UAAU,CAEvC,OAAQ4B,EAAO,CACd,QAAQ,IAAIA,CAAK,CACrB,QAAY,CACRZ,EAAO,UAAU,IAAI,MAAM,CAC5B,CACH,CAEA,eAAejB,GAAsB,CACnC,MAAMgB,EAAY,SAAS,cAAc,eAAe,EAClDC,EAAS,SAAS,cAAc,iBAAiB,EAEvD,QAAQ,UAAU,CAAA,EAAI,GAAI,UAAU,EAEpCD,EAAU,UAAY,GACtBC,EAAO,UAAU,OAAO,MAAM,EAE9B,GAAI,CAGF,MAAMK,GAFO,MAAMxB,KAEC,QACjB,IACC,CAAC,CACC,GAAAD,EACA,MAAA0B,EACA,SAAAC,EACA,aAAcC,EACd,aAAcC,EACd,YAAaC,CACvB,IACeA,EAIE;AAAA;AAAA,sDAEqCA,CAAG,UAAUJ,CAAK;AAAA;AAAA,6CAE3BA,CAAK;AAAA,iFAC+BE,CAAI;AAAA,2EACVC,CAAI;AAAA,sEACT7B,CAAE;AAAA;AAAA;AAAA,QAVrD,EAeZ,EACA,KAAK,EAAE,EACVmB,EAAU,mBAAmB,YAAaM,CAAM,CACjD,OAAQO,EAAO,CACd,QAAQ,IAAIA,CAAK,CACrB,QAAY,CACRZ,EAAO,UAAU,IAAI,MAAM,CAC5B,CACH,CC3LA,MAAMD,EAAY,SAAS,cAAc,eAAe,EAClDc,EAAgB,SAAS,cAAc,kBAAkB,EAE/DA,EAAc,iBAAiB,QAAS3B,GAAS,CAC/CA,EAAM,OAAO,QAAQ,WAAW,EAAE,UAAU,OAAO,QAAQ,EAC3D,SAAS,KAAK,MAAM,SAAW,IACjC,CAAC,EAEDa,EAAU,iBAAiB,QAASe,CAAe,EAEnD,eAAeA,EAAgB5B,EAAO,CACpC,GAAIA,EAAM,OAAO,UAAU,SAAS,kBAAkB,EAAG,CACvD,MAAMN,EAAKM,EAAM,OAAO,QAAQ,GAC1Bc,EAAS,SAAS,cAAc,eAAe,EAC/Ce,EAAU,SAAS,cAAc,QAAQ,EAE/Cf,EAAO,UAAU,OAAO,MAAM,EAE9B,GAAI,CACF,MAAMI,EAAO,MAAMzB,EAAWC,CAAE,EAE1B,CACJ,GAAIoC,EACJ,YAAaN,EACb,MAAAJ,EACA,OAAAW,EACA,aAAAC,EACA,OAAAC,EACA,aAAcC,EACd,SAAAb,CACD,EAAGH,EAEEiB,EAAgBN,EAAQ,cAAc,kBAAkB,EACxDO,EAAgB,CACpB,IAAKP,EAAQ,cAAc,YAAY,EACvC,MAAOA,EAAQ,cAAc,cAAc,EAC3C,OAAQA,EAAQ,cAAc,oBAAoB,EAClD,QAASA,EAAQ,cAAc,sBAAsB,EACrD,OAAQA,EAAQ,cAAc,oBAAoB,EAClD,MAAOA,EAAQ,cAAc,cAAc,CACnD,EACMO,EAAc,IAAI,IAAM,mCAAmCZ,CAAG,GAC9DY,EAAc,IAAI,IAAMhB,EACxBgB,EAAc,MAAM,YAAchB,EAClCgB,EAAc,OAAO,YAAcL,EACnCK,EAAc,QAAQ,YAAcJ,EACpCI,EAAc,OAAO,YAAcF,EACnCE,EAAc,MAAM,YAAcf,EAElCc,EAAc,QAAQ,GAAKL,EAE3BD,EAAQ,UAAU,IAAI,QAAQ,EAC9B,SAAS,KAAK,MAAM,SAAW,SAE/BM,EAAc,iBAAiB,QAASE,CAAgB,CACzD,OAAQX,EAAO,CACd,QAAQ,IAAIA,CAAK,CACvB,QAAc,CACRZ,EAAO,UAAU,IAAI,MAAM,CAC5B,CACF,CACH,CAEA,eAAeuB,EAAiBrC,EAAO,CACrC,MAAMN,EAAKM,EAAM,cAAc,QAAQ,GAEvC,GAAI,CACF,MAAMkB,EAAO,MAAMtB,EAAkBF,CAAE,EAEvC,GAAI,CAACwB,EAAK,QAAQ,OAChBoB,EAAK,KAAK,CACR,KAAM,QACN,MAAO,UACP,KAAM,6CACd,CAAO,MACI,CACL,MAAMC,EAAMrB,EAAK,QAAQ,CAAC,EAAE,IAEXsB,EAAAA,OAAqB;AAAA,iDACKD,CAAG;AAAA,GACjD,EAEY,KAAI,CACd,CACF,OAAQb,EAAO,CACd,QAAQ,IAAIA,CAAK,CAClB,CACH"}